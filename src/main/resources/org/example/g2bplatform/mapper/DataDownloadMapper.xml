<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.example.g2bplatform.mapper.DataDownloadMapper">

    <!-- 계약정보(ContractInfo) 저장 -->
    <insert id="insertContractInfoBatch" parameterType="java.util.List">
        INSERT INTO contract_info_list_thing (
        unty_cntrct_no, bsns_div_nm, dcsn_cntrct_no, cntrct_ref_no, cntrct_nm, cmmn_cntrct_yn,
        lngtrm_ctnu_div_nm, cntrct_cncls_date, cntrct_prd, base_law_nm, tot_cntrct_amt, thtm_cntrct_amt,
        grntymny_rate, cntrct_info_url, pay_div_nm, req_no, ntce_no, cntrct_instt_cd, cntrct_instt_nm,
        cntrct_instt_jrsdctn_div_nm, cntrct_instt_chrg_dept_nm, cntrct_instt_ofcl_nm,
        cntrct_instt_ofcl_tel_no, cntrct_instt_ofcl_fax_no, dminstt_list, corp_list, cntrct_dtl_info_url,
        crdtr_nm, base_dtls, cntrct_cncls_mthd_nm, rgst_dt, chg_dt, dfrcmpnst_rt, link_instt_nm,
        d2b_mng_cntrct_sttus_nm, d2b_mng_prearng_amt, d2b_mng_bid_mthd_nm, d2b_mng_dcsn_no,
        pub_prcrmnt_lrg_clsfc_nm, pub_prcrmnt_mid_clsfc_nm, pub_prcrmnt_clsfc_no, pub_prcrmnt_clsfc_nm,
        cntrct_date, info_biz_yn, yyyymm
        )
        VALUES
        <foreach collection="contractInfos" item="info" separator=",">
            (#{info.untyCntrctNo}, #{info.bsnsDivNm}, #{info.dcsnCntrctNo}, #{info.cntrctRefNo}, #{info.cntrctNm},
            #{info.cmmnCntrctYn}, #{info.lngtrmCtnuDivNm}, #{info.cntrctCnclsDate}, #{info.cntrctPrd}, #{info.baseLawNm},
            #{info.totCntrctAmt}, #{info.thtmCntrctAmt}, #{info.grntymnyRate}, #{info.cntrctInfoUrl}, #{info.payDivNm},
            #{info.reqNo}, #{info.ntceNo}, #{info.cntrctInsttCd}, #{info.cntrctInsttNm}, #{info.cntrctInsttJrsdctnDivNm},
            #{info.cntrctInsttChrgDeptNm}, #{info.cntrctInsttOfclNm}, #{info.cntrctInsttOfclTelNo}, #{info.cntrctInsttOfclFaxNo},
            #{info.dminsttList}, #{info.corpList}, #{info.cntrctDtlInfoUrl}, #{info.crdtrNm}, #{info.baseDtls},
            #{info.cntrctCnclsMthdNm}, #{info.rgstDt}, #{info.chgDt}, #{info.dfrcmpnstRt}, #{info.linkInsttNm},
            #{info.d2bMngCntrctSttusNm}, #{info.d2bMngPrearngAmt}, #{info.d2bMngBidMthdNm}, #{info.d2bMngDcsnNo},
            #{info.pubPrcrmntLrgClsfcNm}, #{info.pubPrcrmntMidClsfcNm}, #{info.pubPrcrmntClsfcNo}, #{info.pubPrcrmntClsfcNm},
            #{info.cntrctDate}, #{info.infoBizYn}, DATE_FORMAT(#{info.rgstDt}, '%Y%m')
            )
        </foreach>
    </insert>

    <!-- 계약정보상세(ContractInfoDetail) 저장 -->
    <insert id="insertContractInfoDetailBatch" parameterType="java.util.List">
        INSERT INTO contract_info_detail_list_thing (
        cntrct_cncls_date, unty_cntrct_no, dcsn_cntrct_no, cntrct_ref_no, prdct_clsfc_no,
        prdct_idnt_no, prdct_clsfc_no_nm, krn_prdct_nm, orgplce_cd, orgplce_nm, qty_uprc_amt,
        prdct_qty, prdct_amt, dlvry_cndtn_cd, dlvry_cndtn_nm, dlvr_daynum, dlvr_tmlmt,
        rgst_dt, chg_dt, yyyymm
        )
        VALUES
        <foreach collection="contractInfoDetails" item="detail" separator=",">
            (#{detail.cntrctCnclsDate}, #{detail.untyCntrctNo}, #{detail.dcsnCntrctNo}, #{detail.cntrctRefNo}, #{detail.prdctClsfcNo},
            #{detail.prdctIdntNo}, #{detail.prdctClsfcNoNm}, #{detail.krnPrdctNm}, #{detail.orgplceCd}, #{detail.orgplceNm},
            #{detail.qtyUprcAmt}, #{detail.prdctQty}, #{detail.prdctAmt}, #{detail.dlvryCndtnCd}, #{detail.dlvryCndtnNm},
            #{detail.dlvrDaynum}, #{detail.dlvrTmlmt}, #{detail.rgstDt}, #{detail.chgDt}, DATE_FORMAT(#{detail.rgstDt}, '%Y%m')
        </foreach>
    </insert>

</mapper>
